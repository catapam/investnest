{% extends "portfolio/portfolio.html" %}
{% load static %}
{% load crispy_forms_tags %}
{% load custom_filters %}

{% block title %}Portfolio Details{% endblock title %}
{% block portfolio_content %}
<div class="container">
    <div class="row">
        <div class="col-md-12">
            <h1 style="color: {{portfolio.color|default:'#FFFFFF'}};">{{ portfolio.name }}</h1>
            <p><strong>Created at:</strong> {{ portfolio.created_at }}</p>
        </div>
    </div>

    <div class="row mt-4">
        <div class="col-md-12">
            <h2>Assets</h2>
            {% if assets %}
                <table class="table table-bordered table-hover">
                    <thead>
                        <tr>
                            <th scope="col">Actions</th>
                            <th scope="col">
                                <a href="?order=name">
                                    Name {% if current_order == 'name' %}▲{% elif current_order == '-name' %}▼{% endif %}
                                </a>
                            </th>
                            <th scope="col">
                                <a href="?order=quantity">
                                    Quantity {% if current_order == 'quantity' %}▲{% elif current_order == '-quantity' %}▼{% endif %}
                                </a>
                            </th>
                            <th scope="col">
                                <a href="?order=price">
                                    Price {% if current_order == 'price' %}▲{% elif current_order == '-price' %}▼{% endif %}
                                </a>
                            </th>
                            <th scope="col">
                                <a href="?order=total_value">
                                    Total Value
                                </a>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for asset in assets %}
                            <tr>
                                <td>
                                    <a href="{% url 'portfolio_edit_asset' portfolio.pk asset.pk %}" class="btn btn-warning">
                                        <i class="fa-solid fa-pencil"></i>
                                    </a>
                                    <a href="{% url 'portfolio_delete_asset' portfolio.pk asset.pk %}" class="btn btn-danger">
                                        <i class="fa-solid fa-trash"></i>
                                    </a>
                                </td>
                                <td>{{ asset.name }}</td>
                                <td>{{ asset.quantity }}</td>
                                <td>{{ asset.price }}</td>
                                <td>{{ asset.quantity|multiply:asset.price }}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            {% else %}
                <p>No assets in this portfolio.</p>
            {% endif %}
        </div>
    </div>

    <div class="row mt-4">
        <div class="col-md-12">
            <a href="{% url 'portfolio_delete' portfolio.pk %}" class="btn btn-danger">Delete Portfolio</a>
            <a href="{% url 'portfolio_add_asset' portfolio.pk %}" class="btn btn-primary">Add Asset</a>
        </div>
    </div>
</div>
{% endblock portfolio_content %}
